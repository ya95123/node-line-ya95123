<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script>
    // * api å…§æ–‡æ•´ç†
    // æ­£å‰‡å»æ‰æ‰€æœ‰çš„htmlæ¨™è¨˜
    const delHtmlTag = (str) => {
      return str.replace(/<[^>]+>/g, '')
    }
    const delSpace = (str) => {
      return str.replace(/&nbsp;/g, '')
    }
    const delDot = (str) => {
      return str.replace(/,/g, ' ')
    }
    const delT = (str) => {
      return str.replace(/T/g, ' ')
    }
    const delLine = (str) => {
      return str.replace(/-/g, '/')
    }
    // * è¨Šæ¯æ¥æ”¶æ•´ç†
    // æœ€æ–°å¹¾å‰‡
    const news = (str) => {
      return str.replace(/n|N/g, '')
    }
    // ç¬¬å¹¾å‰‡
    const order = (str) => {
      return str.replace(/s|S/g, '')
    }
    // å€é–“æ•¸é‡
    const interval = (str) => {
      return str.replace(/-/g, '')
    }

    // const inStart = (str) => {
    //   return str.replace(/-....../g, '')
    // }

    // const inEnd = (str) => {
    //   return str.replace(/.-/g, '')
    // }
    // TODO æ–‡å­—è½‰é™£åˆ—ï¼ï¼ï¼ã€€â†“å³å¯æå– è®šè®šè®š
    let a = '306-308';
    let useA = a.split('-');

    console.log(useA);

    const msgE = 'ç¨‹å¼ç™¼ç”ŸéŒ¯èª¤ï¼'

    // TODO åœ–æ–‡æŒ‰éˆ•(æ­æ´²/ç¾æ´²/ä¸­æ±/äºæ´²)
    // TODO 1.æœ€æ–°3ç¯‡(n3/N3) æ­£å‰‡å¯ä»¥ä¿®æ”¹ n1 n2 n3...OK
    // TODO 2.æŒ‡å®šçœ‹ç¬¬å¹¾ç¯‡ () ex. s1 s2 s3 s4...OK
    // TODO 3.æŒ‡å®šå¹¾åˆ°å¹¾ç¯‡(å€é–“æœ€å¤šç‚ºäº”) 1-5
    const test = async () => {
      // use ç‚ºä½¿ç”¨è€…è¨Šæ¯
      let use = '';
      let msg = []
      let date = new Date();
      try {
        let test = axios.get('https://www.trade.gov.tw/Api/Get/pages?nodeid=45&timeRestrict=true');

        test = await test;
        console.log(test);
        console.log(test.data[1].PageTitle);
        console.log(test.data.length);
        console.log(date);
        console.log(`${date.getMonth() + 1}-${date.getDate()}`);

        // ä½¿ç”¨è€…è¨Šæ¯
        use = '1-4';
        console.log(!isNaN(order(use)));
        // æœ€æ–°Nç¯‡ OK
        // æ­£å‰‡å®Œæ˜¯æ•¸å­— 
        if (!isNaN(news(use)) && (news(use)) >= 1 && (news(use)) <= 5) {
          for (let i = 0; i < news(use); i++) {
            msg[i] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}<hr>`
            if (i === ((news(use)) - 1)) {
              msg[i] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
              document.write(msg);
            }
          }
        }
        // æœ€æ–°Nç¯‡ï¼Œæ•¸å­—è¶…é5(å¤ªå¤š) OK
        else if (!isNaN(news(use)) && (news(use)) > 5) {
          msg[0] = 'æœ€æ–°æ¶ˆæ¯åšå¤šåªèƒ½ç™¼é€å‰äº”å‰‡å”·ğŸ˜Šï¼\næƒ³å¾€å¾Œçœ‹ï¼Œå¯ä»¥ä½¿ç”¨å€é–“æ‰“æ³•(ä¸€æ¬¡æœ€å¤šä¹Ÿæ˜¯5å‰‡è¨Šæ¯)ï¼Œä¾‹å¦‚ï¼š6-10'
          document.write(msg[0]);
        }
        // çœ‹ç¬¬Sç¯‡ OK
        else if (!isNaN(order(use)) && order(use) <= test.data.length) {
          msg[0] = `ç¬¬ ${order(use)} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[order(use) - 1].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[order(use) - 1].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[order(use) - 1].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[order(use) - 1].PageContent))}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
          document.write(msg[0]);
        }
        // çœ‹ç¬¬Sç¯‡ è¶…éè³‡æ–™ç¯„åœ OK
        else if (!isNaN(order(use)) && order(use) > test.data.length || order(use) < 1) {
          msg[0] = `7 å¤©å…§ç›®å‰å…±æœ‰ ${test.data.length} å‰‡æ¶ˆæ¯å”·ï¼Œè«‹å†æ¬¡è¼¸å…¥æ–¼ç¯„åœå…§æœå°‹ğŸŒï¼Œä¾‹å¦‚ï¼šs${test.data.length}`
          document.write(msg[0]);
        }
        // æŒ‡å®šå€é–“
        else if (!isNaN(interval(use))) {
          // æŠŠ use è½‰æˆé™£åˆ—
          use = use.split('-');
          // j ç‚º è¨­å®š msg æ’åº
          // document.write(use[0], use[1]);
          // use = [6, 10] -> è¿´åœˆå¾ i = 5 é–‹å§‹ï¼Œè·‘åˆ° i = 9(10 - 1) çµæŸ
          // TODO è¨Šæ¯å…§å®¹ä¾¿é‚„æ²’æ”¹å®Œ å¢åŠ è®Šæ•¸=è¤‡é›œçš„å…§å®¹
          for (i = use[0] - 1; i < use[1]; i++) {
            for (let j = 0; j < (use[1] - use[0]); j++) {
              msg[j] = `ç¬¬ ${use[0] - 1 + (j + 1)} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[use[0] - 1 + (j + 1)].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[use[0] - 1 + (j + 1)].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[use[0] - 1 + (j + 1)].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[use[0] - 1 + (j + 1)].PageContent))}<hr>`

              if (i === (use[1] - 1)) {
                msg[j] = `ç¬¬ ${use[0] - 1 + (j + 1)} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[use[0] - 1 + (j + 1)].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[use[0] - 1 + (j + 1)].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[use[0] - 1 + (j + 1)].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[use[0] - 1 + (j + 1)].PageContent))}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
                document.write(msg);
              }
            }
          }
        }
        else {
          msg[0] = 'æˆ‘å¥½åƒçœ‹ä¸æ‡‚å•Š...ä½ æ˜¯æƒ³è·Ÿæˆ‘èŠå¤©å—?\næˆ–æ˜¯åˆ° ç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²æŸ¥è©¢ï¼š\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4'
          document.write(msg[0]);
        }










        // TODO æ™‚é–“
        // msg[i] = `${i + 1})å°ç£æ™‚é–“ï¼š${delT(test.data[i].PagePublishTime)}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ è¿‘æœŸæ¶ˆæ¯ â­\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delHtmlTag(test.data[i].PageContent)}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
        // }

        // æŠ“æ—¥æœŸæˆåŠŸäº†å”·!!!
        // for (let i = 0; i < test.data.length; i++) {
        //   if (test.data[i].PagePublishTime.includes(`5-21`)) {
        //     msg[i] = test.data[i].PageTitle + test.data[i].PagePublishTime
        //   }

        //   document.write(`${msg[i]}<hr>`);
        // }


      } catch (error) {
        msg = 'ç›®å‰æ²’æœ‰è³‡è¨Š'
      }
      // event.reply(msg)
    }
    // å‘¼å«test
    test();
  </script>
</body>

</html>