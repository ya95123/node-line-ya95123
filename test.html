<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script>
    // * api å…§æ–‡æ•´ç†
    // æ­£å‰‡å»æ‰æ‰€æœ‰çš„htmlæ¨™è¨˜
    const delHtmlTag = (str) => {
      return str.replace(/<[^>]+>/g, '')
    }
    const delSpace = (str) => {
      return str.replace(/&nbsp;/g, '')
    }
    const delDot = (str) => {
      return str.replace(/,/g, ' ')
    }
    const delT = (str) => {
      return str.replace(/T/g, ' ')
    }
    const delLine = (str) => {
      return str.replace(/-/g, '/')
    }
    // * è¨Šæ¯æ¥æ”¶æ•´ç†
    // æœ€æ–°å¹¾å‰‡
    const news = (str) => {
      return str.replace(/n|N/g, '')
    }
    // ç¬¬å¹¾å‰‡ã€æŒ‡å®šåœ‹å®¶/æ´²
    const order = (str) => {
      return str.replace(/s|S/g, '')
    }
    // å€é–“æ•¸é‡
    const interval = (str) => {
      return str.replace(/-/g, '')
    }
    // å…¨åŸŸæœå°‹
    const all = (str) => {
      return str.replace(/g|G/g, '')
    }
    // æ—¥æœŸåˆ¤æ–·ç”¨
    const dayif = (str) => {
      return str.replace(/@/g, '')
    }
    // æ—¥æœŸç›®éŒ„ . -> - æŠ“ç›¸åŒæ—¥æœŸç”¨
    const day = (str) => {
      return str.replace(/@/g, '-')
    }

    const msgE = 'ç¨‹å¼ç™¼ç”ŸéŒ¯èª¤ï¼'

    // TODO åœ–æ–‡æŒ‰éˆ•(æ­æ´²/ç¾æ´²/ä¸­æ±/äºæ´²)
    // TODO 1.æœ€æ–°3ç¯‡(n3/N3) æ­£å‰‡å¯ä»¥ä¿®æ”¹ n1 n2 n3...OK
    // TODO 2.æŒ‡å®šçœ‹ç¬¬å¹¾ç¯‡ () ex. s1 s2 s3 s4...OK
    // TODO 3.æŒ‡å®šå¹¾åˆ°å¹¾ç¯‡(å€é–“æœ€å¤šç‚ºäº”) 1-5 OK
    const test = async () => {
      // use ç‚ºä½¿ç”¨è€…è¨Šæ¯
      let use = ''
      let msg = ['', '']
      let date = new Date()
      try {
        let test = axios.get('https://www.trade.gov.tw/Api/Get/pages?nodeid=45&timeRestrict=true');

        test = await test;
        console.log(test);
        console.log(test.data[1].PageTitle);
        console.log(test.data.length);
        console.log(date);
        console.log(`${date.getMonth() + 1}-${date.getDate()}`);

        // ä½¿ç”¨è€…è¨Šæ¯
        use = '?c'
        console.log((day(use)))
        // æœ€æ–°Nç¯‡ OK
        // æ­£å‰‡å®Œæ˜¯æ•¸å­— 
        if (!isNaN(news(use)) && (news(use)) >= 1 && (news(use)) <= 5 && use.includes('n') || use.includes('N')) {
          for (let i = 0; i < news(use); i++) {
            msg[i] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}<hr>`
            if (i === ((news(use)) - 1)) {
              msg[i] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
              document.write(msg)
            }
          }
        }
        // æœ€æ–°Nç¯‡ï¼Œæ•¸å­—è¶…é5(å¤ªå¤š) OK
        else if (!isNaN(news(use)) && (news(use)) > 5 && use.includes('n') || use.includes('N')) {
          msg[0] = 'æœ€æ–°æ¶ˆæ¯åšå¤šåªèƒ½ç™¼é€å‰äº”å‰‡å”·ğŸ˜Šï¼\næƒ³å¾€å¾Œçœ‹ï¼Œå¯ä»¥ä½¿ç”¨å€é–“æ‰“æ³•(ä¸€æ¬¡æœ€å¤šä¹Ÿæ˜¯5å‰‡æ¶ˆæ¯)ï¼Œä¾‹å¦‚ï¼š6-10\n\nè‹¥æ˜¯è¦æŒ‡å®šç¬¬å¹¾å‰‡æ¶ˆæ¯ï¼Œè«‹åœ¨æ•¸å­—å‰é¢åŠ ä¸Š"s"å”·ï¼Œä¾‹å¦‚ï¼šs20'
          document.write(msg[0])
        }
        // çœ‹ç¬¬Sç¯‡ OK
        else if (!isNaN(order(use)) && order(use) <= test.data.length && use.includes('s') || use.includes('S')) {
          msg[0] = `ç¬¬ ${order(use)} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[order(use) - 1].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[order(use) - 1].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[order(use) - 1].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[order(use) - 1].PageContent))}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
          document.write(msg[0])
        }
        // çœ‹ç¬¬Sç¯‡ è¶…éè³‡æ–™ç¯„åœ OK
        else if (!isNaN(order(use)) && order(use) > test.data.length || order(use) < 1 && use.includes('s') || use.includes('S')) {
          msg[0] = `7 å¤©å…§ç›®å‰å…±æœ‰ ${test.data.length} å‰‡æ¶ˆæ¯å”·ï¼Œè«‹å†æ¬¡è¼¸å…¥æ–¼ç¯„åœå…§æœå°‹ğŸŒï¼Œä¾‹å¦‚ï¼šs${test.data.length}`
          document.write(msg[0])
        }
        // æŒ‡å®šå€é–“ - OK
        else if (!isNaN(interval(use)) && use.includes('-')) {
          // æŠŠ use è½‰æˆé™£åˆ—
          use = use.split('-')
          console.log(`${use[0]}-${use[1]}`);
          if (use[1] - use[0] < 0) {
            msg[0] = `ç¬¬äºŒå€‹æ•¸å­—è¦æ¯”ç¬¬ä¸€å€‹æ•¸å­—å¤§å•¦ï½ ä¸ç„¶æˆ‘ä¸æœƒæ‰¾å•¦ğŸ¤­ï¼Œä¾‹å¦‚:11-15`
            document.write(msg)
          }
          else if (use[1] - use[0] > 4) {
            msg[0] = 'æœ€å¤šåªèƒ½ç™¼é€äº”å‰‡æ¶ˆæ¯å”·ğŸ˜Šï¼\nä¾‹å¦‚ï¼š6-10'
            document.write(msg)
          }
          // è¶…éæœå°‹ç¯„åœ
          else if (use[0] > test.data.length || use[1] > test.data.length || use[0] < 1) {
            msg[0] = 'è¶…å‡ºæœå°‹ç¯„åœå•¦ğŸ’†â€â™‚ï¼å¯ä»¥å…ˆæŸ¥çœ‹ç›®éŒ„ç¸½å…±æœ‰å¹¾å‰‡æ¶ˆæ¯å”·ï¼\nç›®éŒ„æŸ¥è©¢è«‹è¼¸å…¥ c'
            document.write(msg)
          }
          else {
            // count ç‚º è¨­å®š msg çš„æ’åº
            let count = -1
            for (let i = use[0] - 1; i < use[1]; i++) {
              count = count + 1
              msg[count] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}<hr>`
              if (i === use[1] - 1) {
                msg[count] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
                document.write(`${msg}<br>æˆ‘æ²’æœ‰é‡è¤‡è·‘å°±æˆåŠŸäº†!`)
              }
            }
          }
        }
        // å‘¼å«ç›®éŒ„ c OK
        else if (use === 'ç›®éŒ„' || use === 'c' || use === 'C') {
          for (let i = 0; i < test.data.length; i++) {
            msg[0] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
            if (i === test.data.length - 1) {
              msg[0] += `s${i + 1}ï¼š${test.data[i].PageTitle}`
              document.write(msg)
            }
          }
        }
        // æ‰¾åœ‹å®¶ã€æ´²ç›®éŒ„ såœ‹å®¶/æ´²/åœ°å€ OK
        else if (isNaN(order(use)) && use.includes('s') || use.includes('S')) {
          for (let i = 0; i < test.data.length; i++) {
            // ç¢ºèªåœ‹å®¶
            msg[0] = `ğŸ“ ${order(use)}\nè«‹å†è¼¸å…¥å°æ‡‰çš„æŒ‡å®šä»£è™Ÿï¼Œå³å¯æŸ¥çœ‹å…§å®¹ğŸ”<br>`
            if (test.data[i].PageSummary.includes(order(use))) {
              msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
            }
            if (i === test.data.length - 1) {
              if (test.data[i].PageSummary.includes(order(use))) {
                msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
              }
              else if (msg[1] === '') {
                msg[0] = `7å¤©å…§æ²’æœ‰ "${order(use)}" çš„æ¶ˆæ¯ï¼Œè«‹å†å˜—è©¦æœå°‹åˆ¥çš„åœ°å€ğŸš€`
              }
              document.write(msg)
            }

          }
        }
        // æ‰¾åœ‹å®¶ã€æ´²ç›¸é—œç›®éŒ„(æ¨™é¡Œ&åœ‹å®¶çš†æœå°‹,å…¨åŸŸæœå°‹) g ok
        else if (isNaN(all(use)) && use.includes('g') || use.includes('G')) {
          msg[0] = `æœ‰é—œ ğŸŒ ${all(use)} çš„æ‰€æœ‰è³‡è¨Š\nè«‹å†è¼¸å…¥å°æ‡‰çš„æŒ‡å®šä»£è™Ÿï¼Œå³å¯æŸ¥çœ‹å…§å®¹ğŸ”<br>`
          for (let i = 0; i < test.data.length; i++) {
            if (test.data[i].PageTitle.includes(all(use)) || test.data[i].PageSummary.includes(all(use))) {
              msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
            }
            if (i === test.data.length - 1) {
              if (test.data[i].PageTitle.includes(all(use)) || test.data[i].PageSummary.includes(all(use))) {
                msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
              }
              else if (msg[1] === '') {
                msg[0] = `7å¤©å…§æ²’æœ‰ "${all(use)}" çš„ç›¸é—œæ¶ˆæ¯ï¼Œè«‹å†å˜—è©¦æœå°‹åˆ¥çš„åœ°å€ğŸš€`
              }
              document.write(msg)
            }
          }
        }
        // æ‰¾æ—¥æœŸï¼Œé¡¯ç¤ºç‚ºé‚£å¤©æ¨™é¡Œç›®éŒ„ @ OK
        else if (!isNaN(dayif(use)) && use.includes('@') || use.includes('ï¼ ')) {
          let textTime = use.split('@')
          msg[0] = `ğŸ—“ ${textTime[0]}æœˆ${textTime[1]}æ—¥ <br>`
          for (let i = 0; i < test.data.length; i++) {
            if (test.data[i].PagePublishTime.includes(day(use))) {
              msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
            }
            if (i === test.data.length - 1) {
              if (test.data[i].PagePublishTime.includes(day(use))) {
                msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
              }
              if (msg[1] === '') {
                msg[0] = `åªèƒ½æŸ¥è©¢7å¤©å…§ç™¼å¸ƒçš„æ¶ˆæ¯å”·âœ¨`
              }
              document.write(msg)
            }
          }
        }
        // æ‰¾ä»Šå¤©ï¼Œtoday OK
        else if (use === 'today' || use === 'ä»Šå¤©' || use === 'ä»Šæ—¥') {
          let today = `${date.getMonth() + 1}-${date.getDate()}`
          msg[0] = `ğŸ—“ ${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥\n<br>`

          for (let i = 0; i < test.data.length; i++) {
            if (test.data[i].PagePublishTime.includes(today))
              msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
            if (i === test.data.length - 1) {
              console.log('è¿‘ä¾†2');
              if (test.data[i].PagePublishTime.includes(today)) {
                msg[1] += `s${i + 1}ï¼š${test.data[i].PageTitle}\n<br>`
              }
              document.write(msg)
            }
          }
        }
        // åŠŸèƒ½(åç¨±æ’ç‰ˆ)
        else if (use === '?' || use === 'åŠŸèƒ½' || use === 'f') {
          document.write(`
          åŠŸèƒ½(åç¨±)\n<br>
          ğŸ§± æœ€æ–°ç™¼å¸ƒæ¶ˆæ¯(è‡³å¤š5å‰‡)ï¼šn + æ•¸å­—ï¼Œä¾‹å¦‚ï¼šn3\n<br>
          ğŸ§± æŒ‡å®šç¬¬å¹¾å‰‡æ¶ˆæ¯ï¼šs + æ•¸å­—ï¼Œä¾‹å¦‚ï¼šs10\n<br>\n<br>
          ğŸ§± æ‰€æœ‰æ¶ˆæ¯ç›®éŒ„ï¼šc\n<br>\n<br>
          ğŸ§± æŒ‡å®šåœ°å€çš„æ‰€æœ‰æ¶ˆæ¯ç›®éŒ„ï¼šs + åœ‹å®¶(æˆ–åœ°å€)ï¼Œä¾‹å¦‚ï¼šséæ´²\n<br>
          ğŸ§± æŒ‡å®šåœ°å€çš„{æ‰€æœ‰ç›¸é—œ}æ¶ˆæ¯ç›®éŒ„ï¼šg + åœ‹å®¶(æˆ–åœ°å€)ï¼Œä¾‹å¦‚ï¼šgä¸­æ±\n<br>
          ğŸ§± ä»Šæ—¥çš„æ¶ˆæ¯ç›®éŒ„ï¼štoday\n<br>
          ğŸ§± è©²æ—¥æœŸçš„æ¶ˆæ¯ç›®éŒ„ï¼šæœˆ@æ—¥ï¼Œä¾‹å¦‚ï¼š5@22\n<br>\n<br>
          ğŸ§± åŠŸèƒ½æŸ¥è©¢(åç¨±åˆ†é¡)ï¼š?\n<br>
          ğŸ§± åŠŸèƒ½æŸ¥è©¢(æŒ‡ä»¤åˆ†é¡)ï¼š?c\n<br>\n<br>

          é–‹å§‹è©¦è©¦çœ‹å§ğŸ˜Šï¼
          `)
        }
        // åŠŸèƒ½(æŒ‡ä»¤æ’ç‰ˆ)
        else if (use === '?c' || use === 'åŠŸèƒ½c' || use === 'fc') {
          document.write(`
          åŠŸèƒ½(æŒ‡ä»¤)\n<br>
          ğŸ§± n + æ•¸å­—ï¼šæŸ¥è©¢"æœ€æ–°ç™¼å¸ƒæ¶ˆæ¯"(è‡³å¤š5å‰‡) ä¾‹å¦‚ï¼šn3\n<br>
          ğŸ§± s + æ•¸å­—ï¼šæŒ‡å®š"ç¬¬å¹¾å‰‡æ¶ˆæ¯" ä¾‹å¦‚ï¼šs10 \n<br>
          ğŸ§± s + åœ‹å®¶(æˆ–åœ°å€)ï¼šæŸ¥è©¢"æŒ‡å®šåœ°å€çš„æ¶ˆæ¯æ¨™é¡Œç›®éŒ„" ä¾‹å¦‚ï¼šséæ´²\n<br>
          ğŸ§± g + åœ‹å®¶(æˆ–åœ°å€)ï¼šæŸ¥è©¢"æŒ‡å®šåœ°å€çš„{æ‰€æœ‰ç›¸é—œ}æ¶ˆæ¯æ¨™é¡Œç›®éŒ„" ä¾‹å¦‚ï¼šgä¸­æ±\n<br>
          ğŸ§± cï¼šå«å‡ºæ‰€æœ‰æ¶ˆæ¯æ¨™é¡Œç›®éŒ„ \n<br>
          ğŸ§± todayï¼šæŸ¥è©¢"ä»Šæ—¥çš„æ¶ˆæ¯æ¨™é¡Œç›®éŒ„"\n<br>
          ğŸ§± æœˆ@æ—¥ï¼šæŸ¥è©¢"è©²æ—¥æœŸçš„æ¶ˆæ¯æ¨™é¡Œç›®éŒ„" ä¾‹å¦‚ï¼š5@22\n<br>
          ğŸ§± ?ï¼šåŠŸèƒ½æŸ¥è©¢(åç¨±åˆ†é¡) \n<br>
          ğŸ§± ?cï¼šåŠŸèƒ½æŸ¥è©¢(æŒ‡ä»¤åˆ†é¡) \n<br>\n<br>

          é–‹å§‹è©¦è©¦çœ‹å§ğŸ˜Šï¼
          `)
        }
        else {
          msg[0] = 'æˆ‘å¥½åƒçœ‹ä¸æ‡‚å•Š...ä½ æ˜¯æƒ³è·Ÿæˆ‘èŠå¤©å—?ğŸ‘¼(ä¸éæé¾æˆ‘é‚„æ²’å­¸æœƒèŠå¤©...)\næˆ–è€…è«‹ä½ è¼¸å…¥æ­£ç¢ºæŒ‡ä»¤ï¼Œä¸æ¸…æ¥šå¯è¼¸å…¥ f æŸ¥çœ‹ï¼Œ\næˆ–æ˜¯åˆ° ç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²æœè©¢ç›¸é—œè³‡è¨Šï¼š\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4'
          document.write(msg[0]);
        }


      } catch (error) {
        msg = 'ç›®å‰æ²’æœ‰è³‡è¨Š'
      }
      // event.reply(msg)
    }
    // å‘¼å«test
    test();
  </script>
</body>

</html>