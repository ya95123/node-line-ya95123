<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script>
    // * api å…§æ–‡æ•´ç†
    // æ­£å‰‡å»æ‰æ‰€æœ‰çš„htmlæ¨™è¨˜
    const delHtmlTag = (str) => {
      return str.replace(/<[^>]+>/g, '')
    }
    const delSpace = (str) => {
      return str.replace(/&nbsp;/g, '')
    }
    const delDot = (str) => {
      return str.replace(/,/g, ' ')
    }
    const delT = (str) => {
      return str.replace(/T/g, ' ')
    }
    const delLine = (str) => {
      return str.replace(/-/g, '/')
    }
    // * è¨Šæ¯æ¥æ”¶æ•´ç†
    // æœ€æ–°å¹¾å‰‡
    const news = (str) => {
      return str.replace(/n/g, '')
    }
    // ç¬¬å¹¾å‰‡
    const order = (str) => {
      return str.replace(/s/g, '')
    }
    // å€é–“æ•¸é‡
    const dash = (str) => {
      return str.replace(/~/g, '')
    }

    const msgE = 'ç¨‹å¼ç™¼ç”ŸéŒ¯èª¤ï¼'

    // TODO åœ–æ–‡æŒ‰éˆ•(æ­æ´²/ç¾æ´²/ä¸­æ±/äºæ´²)
    // TODO 1.æœ€æ–°3ç¯‡(n3/N3) æ­£å‰‡å¯ä»¥ä¿®æ”¹ n1 n2 n3...
    // TODO 2.æŒ‡å®šçœ‹ç¬¬å¹¾ç¯‡ () ex. s1 s2 s3 s4...
    // TODO 3.æŒ‡å®šå¹¾åˆ°å¹¾ç¯‡(å€é–“æœ€å¤šç‚ºäº”) 1-5
    const test = async () => {
      // use ç‚ºä½¿ç”¨è€…è¨Šæ¯
      let use = '';
      let msg = []
      let date = new Date();
      try {
        let test = axios.get('https://www.trade.gov.tw/Api/Get/pages?nodeid=45&timeRestrict=true');

        test = await test;
        console.log(test);
        console.log(test.data[1].PageTitle);
        console.log(test.data.length);
        console.log(date);
        console.log(`${date.getMonth() + 1}-${date.getDate()}`);

        // æœ€æ–°ä¸‰ç¯‡
        use = 'n66';
        // æ­£å‰‡å®Œæ˜¯æ•¸å­—
        if (!isNaN(news(use)) && parseInt(news(use)) <= 5) {
          for (let i = 0; i < news(use); i++) {
            msg[i] = `ç¬¬ ${i + 1} å‰‡\nå°ç£æ™‚é–“ï¼š${delLine(delT(test.data[i].PagePublishTime))}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ æœ€æ–°æ¶ˆæ¯\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delSpace(delHtmlTag(test.data[i].PageContent))}<hr>`
            document.write(msg[i]);
          }
        }
        else if (!isNaN(news(use)) && parseInt(news(use)) > 5) {
          msg[0] = 'æœ€æ–°æ¶ˆæ¯åšå¤šåªèƒ½ç™¼é€å‰äº”å‰‡å”·ğŸ˜Šï¼\næƒ³å¾€å¾Œçœ‹ï¼Œå¯ä»¥ä½¿ç”¨å€é–“æ‰“æ³•(ä¸€æ¬¡æœ€å¤šä¹Ÿæ˜¯5å‰‡è¨Šæ¯)ï¼Œä¾‹å¦‚ï¼š6-10'
          document.write(msg[0]);
        }
        else {
          msg[0] = 'æˆ‘å¥½åƒçœ‹ä¸æ‡‚å•Š...ä½ æ˜¯æƒ³è·Ÿæˆ‘èŠå¤©å—?\næˆ–æ˜¯åˆ° ç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²æŸ¥è©¢ï¼š\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4'
          document.write(msg[0]);
        }










        // TODO æ™‚é–“
        // msg[i] = `${i + 1})å°ç£æ™‚é–“ï¼š${delT(test.data[i].PagePublishTime)}\nåœ°å€ï¼š${delDot(test.data[i].PageSummary)}\nâ­ è¿‘æœŸæ¶ˆæ¯ â­\n${test.data[i].PageTitle}\n\nğŸ“¨ ä¸»è¦å…§å®¹\n${delHtmlTag(test.data[i].PageContent)}\næ¶ˆæ¯ä¾†æºçš†è‡ªï¼š\nç¶“æ¿Ÿéƒ¨åœ‹éš›è²¿æ˜“å±€ ç¶“è²¿è³‡è¨Šç¶²\nhttps://www.trade.gov.tw/World/List.aspx?code=7020&nodeID=45&areaID=4&country=b645Lit5ZyL5aSn6Zm4`
        // }

        // æŠ“æ—¥æœŸæˆåŠŸäº†å”·!!!
        // for (let i = 0; i < test.data.length; i++) {
        //   if (test.data[i].PagePublishTime.includes(`5-21`)) {
        //     msg[i] = test.data[i].PageTitle + test.data[i].PagePublishTime
        //   }

        //   document.write(`${msg[i]}<hr>`);
        // }


      } catch (error) {
        msg = 'ç›®å‰æ²’æœ‰è³‡è¨Š'
      }
      // event.reply(msg)
    }
    // å‘¼å«test
    test();
  </script>
</body>

</html>